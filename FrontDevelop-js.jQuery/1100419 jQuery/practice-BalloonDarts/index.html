<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Balloon Darts</title>
  <style>
    .inline {
      display: inline-block;
    }

    .none {
      display: none;
    }

    .block {
      display: block;
    }

    #turntable {
      width: 706px;
      height: 715px;
      background-color: paleturquoise;
      overflow: hidden;
    }

    .balloon-svg {
      /* width: 60px;
      height: 60px; */
      fill: transparent;

      /* 原始尺寸 117*154 */
      width: 53.18px;
      height: 70px;
      /* background-image: url(./WaterDrop-6.gif); */
      background-repeat: no-repeat;
      background-position: center;
      background-size: cover;

      /* 不能被選取 */
      user-select: none;
      -webkit-user-drag: none;
    }

    #circle .balloon-svg {
      transform: rotate(180deg);
    }

    .color {
      /* fill: rgb(203, 250, 74); */
      filter: hue-rotate(150deg);
      background-image: url(./WaterDrop-6.gif);
    }

    .bomb {
      /* fill: rgb(250, 74, 156); */

      /* 原始尺寸 115*178 */
      width: 52.27px;
      height: 80.9px;
      background-image: url(./WaterDrop-9.gif);
    }

    #circle .balloon {
      width: 130px;
      height: 250px;
      text-align: center;

      position: absolute;
      left: calc(50% - 65px);
      bottom: 50%;
      /* background-color: rgba(255, 255, 0, 0.425); */

      transform: rotate(0deg);
      /* js有寫旋轉 */
      transform-origin: bottom center;
    }

    #circle {
      margin: 25px;
      position: relative;
    }

    .circleL {
      width: 500px;
      height: 500px;
      border-radius: 50%;

      background-color: rgb(171, 95, 247);
      /* background-image: url('https://i.pinimg.com/564x/cb/16/bb/cb16bb284a2a80c75041c80ba63e62d3.jpg'); */
      transition: transform 2s;
    }

    .circleM {
      width: 300px;
      height: 300px;
      border-radius: 50%;

      left: calc(50% - 150px);
      top: calc(50% - 150px);
      position: absolute;
      z-index: 9;

      background-color: rgba(0, 9, 128, 0.199);
      /* background-image: url(./balloon.png); */
      /* display: block; */
      /* transform-origin: center; */
      transition: transform 3.5s;
    }

    .circleS {
      width: 100px;
      height: 100px;
      border-radius: 50%;

      left: calc(50% - 50px);
      top: calc(50% - 50px);
      position: absolute;
      z-index: 19;

      background-color: rgb(138, 89, 253);
      /* background-image: url(./balloon.png); */
      /* display: block; */
      /* transform-origin: center; */
      transition: transform 1.5s;
    }

    #straight {
      margin: 25px 25px 25px 0;
      width: 125px;
      height: 500px;
      background-color: springgreen;
      overflow: hidden;
    }

    #straight .track {
      background-color: goldenrod;
      width: 60px;
      /* height: 800px; */
      margin: 0 1.25px;

      /* display: inline-block; */
      float: right;
    }

    #straight .track .balloon-svg {
      transform: rotateX(30deg);
    }

    #horizontal {
      margin: 0 65px 25px 65px;
      width: 570px;
      height: 140px;
      background-color: sandybrown;
      overflow: hidden;
    }

    #horizontal .track {
      height: 68px;
      /* width: 900px; */
      margin: 1.5px 0;
      background-color: seagreen;
      /* display: flex; */
      /* flex-wrap: nowrap; */
    }

    #horizontal .track .balloon {
      /* 為了隨機出現的效果，先暫時拿掉 */
      display: inline-block;
    }

    #horizontal .track .balloon-svg {
      transform: rotate(45deg);
      /* float: left; */
      /* 因為現在是 div 會占滿一整排，所以排列起來會變一直排，若不想用 float ，也可以給父元素inline-block 就會變一橫排 */
    }
  </style>
</head>

<body>
  <input type="button" value="開始" id="start">

  <div id="turntable">
    <!-- 10顆內隨機氣球 轉圓 -->
    <div id="circle" class="inline circleL">
      <div class="circleM">
        <div class="circleS"></div>
      </div>
    </div>

    <!-- 5顆內隨機 直走 -->
    <div id="straight" class="inline">
      <div class="track"></div>
      <div class="track"></div>
    </div>

    <!-- 5顆內隨機 橫走 -->
    <div id="horizontal" class="inline">
      <div class="track"></div>
      <div class="track"></div>
    </div>
  </div>

  </div>
  <!-- jquery js -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <!-- jqueryrotate -->
  <!-- <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script> -->
  <!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script> -->
  <!-- <script src="./jQueryRotateCompressed.js"></script> -->
  <script>

    // 將氣球svg成變數，方便隨時呼叫
    const Balloon = (container) => {
      $(container).append(`
      <div class="balloon">
      <div class="balloon-svg"></div>
      </div>`)
    }

    // <svg class="balloon-svg" data-name="balloon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 287.54 377.24"><path d="M285,118C273,50.4,212.82.58,143.91,0c-8.59.91-17.28,1.24-25.74,2.81C46.34,16.1-4.58,81.17.33,153.29Q4,207.42,42,245.77c29.16,29.5,58.62,58.72,88,88,9,9,18.54,8.94,27.53,0,29.34-29.32,59-58.35,87.92-88.08C280.18,210,293.69,167.17,285,118Z" />
    //     <path d="M149.28,348.54c-3.3-4.32-6.84-4.38-10.12-.1-5,6.45-9.88,12.94-14.54,19.6-1.08,1.54-2,4.43-1.26,5.68.95,1.59,3.58,2.84,5.6,3,4.95.42,10,.14,14.94.14,5.15,0,10.32.27,15.44-.14,2-.16,4.6-1.41,5.59-3,.76-1.21,0-4.12-1.09-5.61C159.18,361.46,154.22,355,149.28,348.54Z" />
    //     </svg>

    // 隨機 1~10 數字
    const random = () => {
      return Math.floor(Math.random() * 10) + 1
    }
    // console.log(random);  
    const Random = (r, R) => {
      return Math.floor(Math.random() * R) + r
    }

    // 圓區 加 氣球svg
    for (i = 0; i < 21; i++) {
      if (i > 10) {
        // 轉盤區 - 大圓(11~20) 共10顆
        Balloon('#circle')
        $('#circle .balloon').eq(i).css('transform', `rotate(${i * 36}deg)`)
      } else if (i >= 3 && i <= 10) {
        // 轉盤區 - 中圓(3~10) 共8顆
        Balloon(' .circleM')
        $('#circle .balloon').eq(i).css({
          transform: `rotate(${i * 45 + 19}deg)`,
          height: '160px',
          // backgroundColor: 'rgba(255, 255, 0, 0.425)',
        })
        // console.log(i);
        // 正確寫法為(#circle .balloon)，而不能用(.circleM .balloon)及(#circle .circleM .balloon)，因為是後來添加的，所以會呼叫不到
      } else {
        // 轉盤區 - 小圓(0~2) 共3顆
        Balloon('.circleS')
        $('#circle .balloon').eq(i).css({
          transform: `rotate(${i * 119}deg)`,
          height: '70px',
          // backgroundColor: 'rgba(255, 255, 0, 0.425)',
        })
        // console.log(i);
      }
    }

    // 直走、橫走區 加 氣球svg
    for (i = 0; i < 10; i++) {

      // 直走區
      Balloon('#straight .track')
      // $('#straight .track .balloon').eq(i).attr('data-svg', i)
      // console.log(`${random()}`);

      // 橫走區
      Balloon('#horizontal .track')
    }

    // 開始按鈕事件
    $('#start').click(function () {
      $(this).attr('disabled', true)

      // 直走、橫走區 軌道隨機位移
      timerTrack1 = setInterval(() => {
        // 直走區
        $('#straight .track').eq(0).css({ marginTop: `-${random() * 25}px` })
        // 橫走區
        $('#horizontal .track').eq(1).css({ marginLeft: `-${random() * 35}px` })
      }, 500)
      timerTrack2 = setInterval(() => {
        // 直走區
        $('#straight .track').eq(1).css({ marginTop: `-${random() * 40}px` })
        // 橫走區
        $('#horizontal .track').eq(0).css({ marginLeft: `-${random() * 30}px` })
      }, 1200)

      // 隨機給每個 直走、橫走區 balloon 間距位移
      timerTrackBalloon = setInterval(() => {
        for (i = 0; i < 20; i++) {
          random()
          // 直走區內氣球隨機間距
          $('#straight .track .balloon').eq(i).css({ marginBottom: `${random() * 5}px` })
          // console.log(i);

          // 橫走區內氣球隨機間距
          $('#horizontal .track .balloon').eq(i).css({
            marginRight: `${random() * 5}px`
          })
        }
      }, 2000)

      // 轉盤隨機角度變換
      timerCircleL = setInterval(() => {
        $('.circleL').attr('style', `transform:rotate(${random() * 36}deg)`)
      }, 900)
      timerCircleM = setInterval(() => {
        $('.circleM').attr('style', `transform:rotate(-${random() * 36}deg)`)
      }, 1500)
      timerCircleS = setInterval(() => {
        $('.circleS').attr('style', `transform:rotate(${random() * 36}deg)`)
      }, 1200)

      // 隨機顯示汽球
      for (let i = 0; i < Random(9, 15); i++) {
        $('#circle .balloon .balloon-svg').eq(Random(0, 21)).addClass('color').css({ filter: `hue-rotate(${Random(0, 255)}deg)` })
        // console.log(`${Random(0, 21)}`);
      }

      for (let i = 0; i < Random(8, 13); i++) {
        $('#straight .track .balloon .balloon-svg').eq(Random(0, 20)).addClass('color').css({ filter: `hue-rotate(${Random(0, 255)}deg)` })
        // console.log(`rgb(${Random(0, 255)},${Random(0, 255)},${Random(0, 255)})`);
        // console.log(`${Random(0, 20)}`);

        $('#horizontal .track .balloon .balloon-svg').eq(Random(0, 20)).addClass('color').css({ filter: `hue-rotate(${Random(0, 255)}deg)` })
        // console.log(`${Random(0, 20)}`);
      }

      // 轉盤依照現在的秒數一直轉圈，缺點是60秒與1秒切換時，會轉回原點
      // timer = setInterval(() => {
      //   const sec = new Date().getSeconds()
      //   // const deg = Math.floor(Math.random() * 10)   --好像不能用 random 會抽動
      //   console.log(sec);
      //   $('#circle').attr('style', `transform:rotate(${sec * 60}deg)`)
      // }, 10)

      // 使用 jqueryrotate 轉圈--沒辦法轉完一整圈
      // https://raw.githubusercontent.com/wilq32/jqueryrotate/master/jQueryRotate.js
      // https://jqueryrotate.com/

      // var angle = 0;
      // setInterval(function () {
      //   angle += 3;
      //   $("#circle").rotate(angle);
      //   console.log(angle);
      // }, 100);

      // var rotation = function () {
      //   $('#circle').rotate({
      //     angle: 0,
      //     animateTo: 360,
      //     callback: rotation
      //   })
      // }
      // rotation();

      // https://www.jq22.com/jquery-info375
      // var rotation2 = function () {
      //   $('#circle').rotate({
      //     angle: 0,//初始旋轉的角度數，並且立即執行
      //     animateTo: 360,
      //     duration: 8000,//指定使用animateTo的動畫執行持續時間
      //     callback: rotation2,
      //     easing: function (x, t, b, c, d) {
      //       // t: current time, b: begInnIng value, c: change In value, d: duration
      //       return c * (t / d) + b;
      //     }
      //   });
      // }
      // rotation2();
    })

    $('#turntable').on('click', '.color', function () {
      $(this).addClass('bomb').fadeTo(1100, 0)
      console.log(0);
    })


    // 有問題
    // 轉圈使用 jqueryrotate 沒辦法轉完一整圈
    // 小圓及中圓內的汽球無法點擊，就算設$('#circle .balloon')也一樣 --4/26解決
    // 橫走區汽球移動時有的會疊在一起 -- 4/26 老師建議用 position

    // 待作效果
    // 分解gif  https://dribbble.com/shots/3388942-Water-drop
    // fill="#5b5b5b"  svg顏色隨機
    // 設置飛鏢數量及倒數時間，並計算爆掉汽球顆數
  </script>
</body>

</html>